do empty list
-----
_ do [
]
-----
.
=====
do single
-----
_ do [
    1
]
-----
1
=====
do multiple
-----
_ do [
    1,
    2
]
-----
2
=====
do recursive 1
-----
_ do [
    _ do [
        1,
        2
    ],
    3
]
-----
3
=====
do recursive 2
-----
_ do [
    1,
    _ do [
        2,
        3
    ]
]
-----
3
=====
do return true
-----
_ do [
    1,
    2,
    true .return 3,
    4
]
-----
3
=====
do return false
-----
_ do [
    1,
    2,
    false .return 3,
    4
]
-----
4
=====
do return scope 1
-----
_ do [
    1,
    _ do [
        2,
        true .return 3,
        4
    ],
    5
]
-----
5
=====
do return scope 2
-----
_ do [
    1,
    a = _ do [
        2,
        true .return 3,
        4
    ],
    a + 2
]
-----
5
=====
do return eval
-----
_ do [
    b = 2,
    (b > 0) .return b - 1,
    b + 1
]
-----
1
=====
do list
-----
_ do [
    []
]
-----
[]
=====
test true
-----
true test [1] : [2]
-----
1
=====
test false
-----
false test [1] : [2]
-----
2
=====
test else .
-----
true test [1] : []
-----
1
=====
test conditional eval
-----
_ do [
    a = 1,
    true test [
        1
    ] : [
        a = 2
    ],
    a
]
-----
1
=====
test recursive
-----
true test [
    false test [1] : [2]
] : [
    3
]
-----
2
=====
test return
-----
true test [
    1,
    true .return 2,
    3
] : [
    4
]
-----
2
=====
test return
-----
true test [
    1,
    true .return 2,
    3
] : [
    4
]
-----
2
=====
test list
-----
true test [
    []
] : [
]
-----
[]
=====
switch symbol
-----
.a switch {
    a : [_ not true],
    b : [1]
}
-----
false
=====
switch int
-----
(1 + 2) switch {
    1 : [1],
    2 : [2],
    3 : [_ not true]
}
-----
false
=====
switch text
-----
"a" switch {
    "ab" : [1],
    "a" : [_ not true]
}
-----
false
=====
switch any
-----
"a" switch {
    1 : [2],
    "1" : ["2"],
    a : [b],
    "a" : [.b]
}
-----
b
=====
switch default
-----
1 switch {
} : [.a]
-----
a
=====
switch not eval
-----
_ do [
    a = 0,
    1 switch {
        2 : [a = 1],
        3 : [a = 2]
    },
    a
]
-----
0
=====
switch block
-----
1 switch {
    1 : [a = 2, a]
}
-----
2
=====
match pattern
-----
[1, 2, 3] match [
    [a, b, c] : [a + b + c]
]
-----
6
=====
match order
-----
_ do [
    is_null = _ import .context.is_null,
    [1, 2, 3] match [
        [2, a, b] : [x = 1],
        [1, c, d] : [y = 1],
        [e, 2, f] : [z = 1],
    ],
    [
        .a is_null _,
        .b is_null _,
        c,
        d,
        .e is_null _,
        .f is_null _,
        .x is_null _,
        y,
        .z is_null _
    ]
]
-----
[true, true, 2, 3, true, true, true, 1, true]
=====
match eval
-----
_ do [
    a = 1,
    a match [
        1 : [1 + 2],
        2 : [2 + 3]
    ]
]
-----
3
=====
match exist
-----
1 match [
    1 : [2], 2 : [3]
]
-----
2
=====
match default
-----
3 match [
    1 : [2],
    2 : [3],
    _ : [4]
]
-----
4
=====
match conditional eval exist
-----
_ do [
    is_null = _ import .context.is_null,
    1 match [
        1 : [a = 1],
        2 : [b = 2],
        _ : [c = 3]
    ],
    [a, .b is_null _, .c is_null _]
]
-----
[1, true, true]
=====
match conditional eval default
-----
_ do [
    is_null = _ import .context.is_null,
    3 match [
        1 : [a = 1],
        2 : [b = 2],
        _ : [c = 3]
    ],
    [.a is_null _, .b is_null _, c]
]
-----
[true, true, 3]
=====
match symbol
-----
_ do [
    a = _ form a,
    a match [
        *a : [1],
        *b : [2]
    ]
]
-----
1
=====
match return
-----
1 match [
    1 : [
        2,
        true .return 3,
        4
    ]
]
-----
3
=====
match return
-----
1 match [
    1 : [
        2,
        true .return 3,
        4
    ]
]
-----
3
=====
match do
-----
1 match [
    1 : [1, 2]
]
-----
2
=====
match list
-----
1 match [
    1 : [[]]
]
-----
[]
=====
match bit
-----
true match [
    true : [1],
    false : [2]
]
-----
1
=====
loop false
-----
_ do [
    a = 1,
    false loop [
        a = 2
    ],
    a
]
-----
1
=====
loop multiple
-----
_ do [
    a = 0,
    b = 0,
    (a < 100) loop [
        a = a + 17,
        b = b + 1
    ],
    b
]
-----
6
=====
loop test
-----
_ do [
    <> = _ import .integer.less_greater,
    a = 42,
    b = 24,
    (a <> b) loop [
        (a > b) test [
            a = a - b
        ] : [
            b = b - a
        ]
    ],
    a
]
-----
6
=====
loop continue
-----
_ do [
    a = 0,
    b = 0,
    (b < 5) loop [
        b = b + 1,
        (b == 2) .continue .,
        a = a + b,
    ],
    a
]
-----
13
=====
loop return
-----
_ do [
    a = 0,
    b = 0,
    (b < 5) loop [
        (a > 5) .return a,
        b = b + 1,
        a = a + b,
    ]
]
-----
6
=====
iterate list
-----
_ do [
    sum = 0,
    [1, 2, 3, 4, 5] iterate i : [
        sum = sum + i
    ],
    sum
]
-----
15
=====
iterate empty list
-----
_ do [
    sum = 0,
    [] iterate i : [
        sum = sum + i
    ],
    sum
]
-----
0
=====
iterate return 1
-----
[1, 2, 3, 4, 5] iterate i : [
    (i == 3) .return true
]
-----
true
=====
iterate return 2
-----
_ do [
    [1, 2, 3, 4, 5] iterate i : [
        (i == 3) .return .,
        a = i
    ],
    a
]
-----
2
=====
iterate continue
-----
_ do [
    a = 0,
    b = 0,
    [1, 2, 3, 4, 5] iterate i : [
        a = a + i,
        (i == 3) .continue .,
        b = b + i
    ],
    a : b
]
-----
15 : 12
=====
iterate list map
-----
_ do [
    push = _ import .list.push,
    a = [],
    [1, 2, 3, 4, 5] iterate i : [
        a ; push i + 1
    ],
    a
]
-----
[2, 3, 4, 5, 6]
=====
iterate integer
-----
_ do [
    sum = 0,
    10 iterate i : [
        sum = sum + i
    ],
    sum
]
-----
45
=====
iterate integer 0
-----
_ do [
    sum = 0,
    0 iterate i : [
        sum = sum + i
    ],
    sum
]
-----
0
=====
iterate integer negative
-----
0-1 iterate i : []
-----
.
=====
iterate byte
-----
_ do [
    push = _ import .list.push,
    b = [],
    byte(1122334455) iterate i : [
        b ; push i
    ],
    b
]
-----
[byte(11), byte(22), byte(33), byte(44), byte(55)]
=====
iterate symbol
-----
_ do [
    push = _ import .list.push,
    s = [],
    .abc iterate i : [
        s ; push i
    ],
    s
]
-----
[a, b, c]
=====
iterate text
-----
_ do [
    push = _ import .list.push,
    t = [],
    "hello" iterate i : [
        t ; push i
    ],
    t
]
-----
["h", "e", "l", "l", "o"]
=====
iterate map
-----
_ do [
    push = _ import .list.push,
    new_map = _ import .map.new,
    kv = [],
    {1 : 2, 3 : 4} iterate i : [
        kv ; push i
    ],
    _ new_map kv
]
-----
{1 : 2, 3 : 4}
